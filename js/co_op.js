"use strict";var socket;function connectSocket(){var a;socket&&socket.close(1e3),null===(a=$(".row.message"))||void 0===a?void 0:a.remove(),socket=new WebSocket("wss://tracker-ws.zaxu.xyz"),socket.addEventListener("error",function(){var a=$("#room_id");a.classList.add("active"),a.textContent="Could not connect to server. (Server may be down)"})}function createPRow(a,b){var c=document.createElement("div");c.classList.add("row","message");var d=document.createElement("p");d.textContent=b,c.appendChild(d),a.insertAdjacentElement("afterend",c)}function findCell(a){return $("[src=\"".concat(a.item,"\"]"),$(".grid[data-user-id=\"".concat(a.id,"\"]"))).parentElement}function messageHandler(a,b){var c=JSON.parse(a.data);switch(c.type){case"room_created":{$("#room_id").innerHTML="Created room with ID: <code>".concat(c.id,"</code> (Give this to your teammates!)");break}case"room_joined":{c.id;break}case"user_joined":{var d=$(".grid").cloneNode(!0);d.dataset.userId=c.id,$("main").appendChild(d);break}case"user_left":{$(".grid[data-user-id=\"".concat(c.id,"\"]")).remove();break}case"error":{createPRow(b,"Error: ".concat(c.message));break}case"user_primary":{handlePrimary({currentTarget:findCell(c)},c.offset);break}case"user_secondary":{handleSecondary({currentTarget:findCell(c)});break}case"user_disable":{handleDisable({currentTarget:findCell(c)});break}}}$("#co_op_join").onsubmit=function(a){return connectSocket(a.target),socket.addEventListener("open",function(){socket.send(JSON.stringify({type:"join_room",room:$("#co_op_join input").value}))}),socket.addEventListener("message",function(b){return messageHandler(b,a.target)}),!1},$("#co_op_create").onsubmit=function(a){connectSocket(a.target);var b=parseInt($("#co_op_create input").value);b||(createPRow(a.target,"Invalid or no size given, using default of 2."),b=2);var c=$("#room_id");return c.classList.add("active"),c.textContent="Creating room...",socket.addEventListener("open",function(){socket.send(JSON.stringify({type:"create_room",size:b}))}),socket.addEventListener("message",function(b){return messageHandler(b,a.target)}),!1};var coOpColumnsElem=$("#co_op_columns");try{var _localStorage$coOpCol;coOpColumnsElem.value=null!==(_localStorage$coOpCol=localStorage.coOpColumns)&&void 0!==_localStorage$coOpCol?_localStorage$coOpCol:null}catch(a){}coOpColumnsElem.oninput=function(a){var b=a.target.value,c=$("main");c.style.gridTemplateColumns=b?"repeat(".concat(b,", auto)"):null;try{localStorage.coOpColumns=b}catch(a){}},coOpColumnsElem.oninput({target:coOpColumnsElem});

//# sourceMappingURL=co_op.js.map